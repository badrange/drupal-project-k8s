
# Values in this file override the default values of our helm chart.
#
# See https://github.com/wunderio/charts/blob/master/drupal/values.yaml
# for all possible options.

varnish:
  enabled: false

elasticsearch:
  enabled: false

memcached:
  enabled: false

#drupal:
#  nodeSelector:
#    cloud.google.com/gke-nodepool: persistent


## Cron tasks, each of which will be run into a dedicated temporary pod.
## When overriding this value, make sure to include the `drush cron` command.
#cron:
#  drupal:
#    # ~ gets replaced with a random digit between 0 and 9 to prevent having all cron jobs at once.
#    schedule: '~ * * * *'
#    command: |
#      if [[ "$(drush status --fields=bootstrap)" = *'Successful'* ]] ; then
#        drush cron;
#      fi
#    # Set a nodeSelector specifically for cron jobs.
#    nodeSelector:
#      cloud.google.com/gke-nodepool: static-ip
#    # Set resources specifically for cron jobs.
#    resources:
#      requests:
#        cpu: 100m
#        memory: 250M
#      limits:
#        cpu: 1000m
#        memory: 512M


php:
  resources:
    requests:
      cpu: 5m
      memory: 128M
    limits:
      cpu: 500m
      memory: 512M
#For now the project should run on persistent nodepool.
  nodeSelector:
    cloud.google.com/gke-nodepool: persistent
  cron:
  #default drupal cron running on static nodepool
    static:
      nodeSelector:
        cloud.google.com/gke-nodepool: static-ip
      schedule: '* * * * *'
      command: |
        if [[ "$(drush status --fields=bootstrap)" = *'Successful'* ]] ; then
          drush cron;
          drush cr;
        fi
      resources:
        requests:
          cpu: 5m
          memory: 128M
        limits:
          cpu: 500m
          memory: 512M
#this cron runs on persistent
    persis:
      nodeSelector:
        cloud.google.com/gke-nodepool: persistent
      schedule: '* * * * *'
      command: |
        echo 'Running on persistent'
      resources:
        requests:
          cpu: 5m
          memory: 128M
        limits:
          cpu: 500m
          memory: 512M
#running on default
    dflt:
      nodeSelector: null
      schedule: '* * * * *'
      command: |
        echo 'Running on default nodepool'
      resources:
        requests:
          cpu: 5m
          memory: 128M
        limits:
          cpu: 500m
          memory: 512M

mounts:
  private-files:
    enabled: true



## Allow access from another namespace for testing purposes.
#silta-release:
#  proxy:
#    enabled: true
#    no_proxy: ".example.com"
#  ingressAccess:
#    test:
#      additionalPodSelector:
#        app: drupal
#      from:
#        - namespaceSelector:
#            matchLabels:
#              name: drupal-project
#    allowESaccess:
#      additionalPodSelector:
#        chart: elasticsearch
#      from:
#        - namespaceSelector:
#            matchLabels:
#              name: drupal-project
